!function(t,e){"use strict";if(!e)throw new Error("Filterizr requires jQuery to work.");var i=function(t){this.init(t)};i.prototype={init:function(t){this.root={x:0,y:0,w:t}},fit:function(t){var e,i,r,n=t.length,o=n>0?t[0].h:0;for(this.root.h=o,e=0;e<n;e++)r=t[e],(i=this.findNode(this.root,r.w,r.h))?r.fit=this.splitNode(i,r.w,r.h):r.fit=this.growDown(r.w,r.h)},findNode:function(t,e,i){return t.used?this.findNode(t.right,e,i)||this.findNode(t.down,e,i):e<=t.w&&i<=t.h?t:null},splitNode:function(t,e,i){return t.used=!0,t.down={x:t.x,y:t.y+i,w:t.w,h:t.h-i},t.right={x:t.x+e,y:t.y,w:t.w-e,h:i},t},growDown:function(t,e){var i;return this.root={used:!0,x:0,y:0,w:this.root.w,h:this.root.h+e,down:{x:0,y:this.root.h,w:this.root.w,h:e},right:this.root},(i=this.findNode(this.root,t,e))?this.splitNode(i,t,e):null}},e.fn.filterizr=function(){var t=this,i=arguments;if(t._fltr||(t._fltr=e.fn.filterizr.prototype.init(t,"object"==typeof i[0]?i[0]:void 0)),"string"==typeof i[0]){if(i[0].lastIndexOf("_")>-1)throw new Error("Filterizr error: You cannot call private methods");if("function"!=typeof t._fltr[i[0]])throw new Error("Filterizr error: There is no such function");t._fltr[i[0]](i[1],i[2])}return t},e.fn.filterizr.prototype={init:function(t,i){var r=e(t).extend(e.fn.filterizr.prototype);r.options={animationDuration:.5,callbacks:{onFilteringStart:function(){},onFilteringEnd:function(){},onShufflingStart:function(){},onShufflingEnd:function(){},onSortingStart:function(){},onSortingEnd:function(){}},delay:0,delayMode:"progressive",easing:"ease-out",filter:"all",filterOutCss:{opacity:0,transform:"scale(0.5)"},filterInCss:{opacity:1,transform:"scale(1)"},filterInSeeMoreCss:{opacity:1,transform:"scale(1)"},layout:"sameSize",setupControls:!0,noResultsCssClass:"filterizr-no-results",seeMoreBtnCssSelector:".filterizr-see-more-click",seeMoreNumItemsToShow:-1,seeMoreActiveCssClass:"filterizr-see-more-active"},0===arguments.length&&(i=r.options),1===arguments.length&&"object"==typeof arguments[0]&&(i=arguments[0]),i&&r.setOptions(i),r._setupSeeMoreFeature(),r.css({padding:0,position:"relative"}),r._lastCategory=0,r._isAnimating=!1,r._isShuffling=!1,r._isSorting=!1,r._mainArray=r._getFiltrItems(),r._subArrays=r._makeSubarrays(),r._activeArray=r._getCollectionByFilter(r.options.filter);var n=!1;return r._activeArray&&0!==r._activeArray.length||(n=!0),r._shouldSetNoResultsClass(n),r._toggledCategories={},r._typedText=e("input[data-search]").val()||"",r._uID="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0;return("x"==t?e:3&e|8).toString(16)}),r._setupEvents(),r.options.setupControls&&r._setupControls(),r.filter(r.options.filter),r},filter:function(t){var e=this,i=e._getCollectionByFilter(t);e.options.filter=t,e.trigger("filteringStart"),e._handleFiltering(i),e._isSearchActivated()?e.search(e._typedText):e._activeArray&&e._activeArray.length>0&&e._shouldSetNoResultsClass(!1)},toggleFilter:function(t){var e=this,i=[];e.trigger("filteringStart"),t&&(e._toggledCategories[t]?delete e._toggledCategories[t]:e._toggledCategories[t]=!0),e._multifilterModeOn()?(i=e._makeMultifilterArray(),e._handleFiltering(i),e._isSearchActivated()&&e.search(e._typedText)):(e.filter("all"),e._isSearchActivated()&&e.search(e._typedText))},search:function(t){var e=this,i=e._multifilterModeOn()?e._makeMultifilterArray():e._getCollectionByFilter(e.options.filter),r=[],n=0;if(i){if(e._isSearchActivated())for(n=0;n<i.length;n++)i[n].text().toLowerCase().indexOf(t.toLowerCase())>-1&&r.push(i[n]);if(r.length>0)e._shouldSetNoResultsClass(!1),e._handleFiltering(r);else if(e._isSearchActivated())for(n=0;n<e._activeArray.length;n++)e._activeArray[n]._filterOut();else e._shouldSetNoResultsClass(!1),e._handleFiltering(i)}},shuffle:function(){var t=this;t._isAnimating=!0,t._isShuffling=!0,t.trigger("shufflingStart"),t._mainArray=t._fisherYatesShuffle(t._mainArray),t._subArrays=t._makeSubarrays();var e=t._multifilterModeOn()?t._makeMultifilterArray():t._getCollectionByFilter(t.options.filter);t._isSearchActivated()?t.search(t._typedText):t._placeItems(e)},sort:function(t,e){var i=this;if(t=t||"domIndex",e=e||"asc",i._isAnimating=!0,i._isSorting=!0,i.trigger("sortingStart"),"domIndex"!==t&&"sortData"!==t&&"w"!==t&&"h"!==t)for(var r=0;r<i._mainArray.length;r++)i._mainArray[r][t]=i._mainArray[r].data(t);i._mainArray.sort(i._comparator(t,e)),i._subArrays=i._makeSubarrays();var n=i._multifilterModeOn()?i._makeMultifilterArray():i._getCollectionByFilter(i.options.filter);i._isSearchActivated()?i.search(i._typedText):i._placeItems(n)},setOptions:function(t){var e=this,i=0;for(var r in t)e.options[r]=t[r];if(e._mainArray&&(t.animationDuration||t.delay||t.easing||t.delayMode))for(i=0;i<e._mainArray.length;i++)e._mainArray[i].css("transition","all "+e.options.animationDuration+"s "+e.options.easing+" "+e._mainArray[i]._calcDelay()+"ms");t.callbacks&&(t.callbacks.onFilteringStart||(e.options.callbacks.onFilteringStart=function(){}),t.callbacks.onFilteringEnd||(e.options.callbacks.onFilteringEnd=function(){}),t.callbacks.onShufflingStart||(e.options.callbacks.onShufflingStart=function(){}),t.callbacks.onShufflingEnd||(e.options.callbacks.onShufflingEnd=function(){}),t.callbacks.onSortingStart||(e.options.callbacks.onSortingStart=function(){}),t.callbacks.onSortingEnd||(e.options.callbacks.onSortingEnd=function(){})),e.options.filterInCss.transform||(e.options.filterInCss.transform="translate3d(0,0,0)"),e.options.filterOutCss.transform||(e.options.filterOutCss.transform="translate3d(0,0,0)")},_getFiltrItems:function(){var t=this._isSeeMoreActive,i=this.options.seeMoreNumItemsToShow,n=0,o=!1,s=this,a=null,l=[];return t?a=e(s.find(".filtr-item").slice(0,i)):this._mainArray&&this._mainArray.length>0?(a=e(s.find(".filtr-item").slice(i)),n=this._mainArray.length,o=!0):a=e(s.find(".filtr-item")),e.each(a,function(t,i){var a=e(i);a.addClass("filterizd");var f=a.extend(r)._init(n+t,s,{shouldUseFilterInSeeMoreCss:o});l.push(f)}),l},_shouldSetNoResultsClass:function(t){t?this.addClass(this.options.noResultsCssClass):this.removeClass(this.options.noResultsCssClass)},_makeSubarrays:function(){for(var t=this,e=[],i=0;i<t._lastCategory;i++)e.push([]);for(i=0;i<t._mainArray.length;i++)if("object"==typeof t._mainArray[i]._category)for(var r=t._mainArray[i]._category?t._mainArray[i]._category.length:0,n=0;n<r;n++)e&&t._mainArray[i]._category&&e[t._mainArray[i]._category[n]-1].push(t._mainArray[i]);else e&&t._mainArray[i]._category&&e[t._mainArray[i]._category-1].push(t._mainArray[i]);return e},_makeMultifilterArray:function(){for(var t=this,e=[],i={},r=0;r<t._mainArray.length;r++){var n=t._mainArray[r],o=!1,s=n.domIndex in i==!1;if(Array.isArray(n._category)){for(var a=0;a<n._category.length;a++)if(n._category[a]in t._toggledCategories){o=!0;break}}else n._category in t._toggledCategories&&(o=!0);s&&o&&(i[n.domIndex]=!0,e.push(n))}return e},_setupControls:function(){var t=this;e("*[data-filter]").click(function(){var i=e(this).data("filter");t.options.filter!==i&&t.filter(i)}),e("*[data-multifilter]").click(function(){var i=e(this).data("multifilter");"all"===i?(t._toggledCategories={},t.filter("all")):t.toggleFilter(i)}),e("*[data-shuffle]").click(function(){t.shuffle()}),e("*[data-sortAsc]").click(function(){var i=e("*[data-sortOrder]").val();t.sort(i,"asc")}),e("*[data-sortDesc]").click(function(){var i=e("*[data-sortOrder]").val();t.sort(i,"desc")}),e("input[data-search]").keyup(function(){t._typedText=e(this).val(),t._delayEvent(function(){t.search(t._typedText)},250,t._uID)})},_setupEvents:function(){var i=this;e(t).resize(function(){i._delayEvent(function(){i.trigger("resizeFiltrContainer")},250,i._uID)}),i.on("resizeFiltrContainer",function(){i._multifilterModeOn()?i.toggleFilter():i.filter(i.options.filter)}).on("filteringStart",function(){i.options.callbacks.onFilteringStart()}).on("filteringEnd",function(){i.options.callbacks.onFilteringEnd()}).on("shufflingStart",function(){i._isShuffling=!0,i.options.callbacks.onShufflingStart()}).on("shufflingEnd",function(){i.options.callbacks.onShufflingEnd(),i._isShuffling=!1}).on("sortingStart",function(){i._isSorting=!0,i.options.callbacks.onSortingStart()}).on("sortingEnd",function(){i.options.callbacks.onSortingEnd(),i._isSorting=!1})},_calcItemPositions:function(){var t=this;if(!t._activeArray||0===t._activeArray.length)return[];var r,n=t._activeArray,o=0,s=Math.round(t.width()/t.find(".filtr-item").outerWidth()),a=0,l=n[0].outerWidth(),f=0,u=0,h=0,c=0,_=0,g=[];for(r=0;r<n.length;r++)n[r]._unsetForcedHeight();if("packed"===t.options.layout){e.each(t._activeArray,function(t,e){e._updateDimensions()});var d=new i(t.outerWidth());for(d.fit(t._activeArray),c=0;c<n.length;c++)g.push({left:n[c].fit.x,top:n[c].fit.y});o=d.root.h}if("horizontal"===t.options.layout)for(a=1,c=1;c<=n.length;c++)l=n[c-1].outerWidth(),f=n[c-1].outerHeight(),g.push({left:u,top:h}),u+=l,o<f&&(o=f);else if("vertical"===t.options.layout){for(c=1;c<=n.length;c++)f=n[c-1].outerHeight(),g.push({left:u,top:h}),h+=f;o=h}else if("sameHeight"===t.options.layout){a=1;S=t.outerWidth();for(c=1;c<=n.length;c++){l=n[c-1].width();var p=n[c-1].outerWidth(),y=0;n[c]&&(y=n[c].width()),g.push({left:u,top:h}),(_=u+l+y)>S?(_=0,u=0,h+=n[0].outerHeight(),a++):u+=p}o=a*n[0].outerHeight()}else if("sameWidth"===t.options.layout){for(c=1;c<=n.length;c++){if(g.push({left:u,top:h}),c%s==0&&a++,u+=l,h=0,a>0)for(_=a;_>0;)h+=n[c-s*_].outerHeight(),_--;c%s==0&&(u=0)}for(c=0;c<s;c++){for(var m=0,v=c;n[v];)m+=n[v].outerHeight(),v+=s;m>o?(o=m,m=0):m=0}}else if("sameSize"===t.options.layout){for(c=1;c<=n.length;c++)g.push({left:u,top:h}),u+=l,c%s==0&&(h+=n[0].outerHeight(),u=0);o=(a=Math.ceil(n.length/s))*n[0].outerHeight()}else if("variedHeightAndWidth"===t.options.layout){a=1;var S=t.outerWidth(),A=0,C=[],x=0;for(c=1;c<=n.length;c++){l=n[c-1].width();var p=n[c-1].outerWidth(),y=0;n[c]&&(y=n[c].width()),g.push({left:u,top:h}),(_=u+l+y)>S?(_=0,u=0,h+=x=t._getMaxHeightOfArrayItems(n.slice(A,c)),C.push(x),A=c,a++):u+=p}C.push(t._getMaxHeightOfArrayItems(n.slice(A,c))),o=C.reduce(function(t,e,i){return t+e},0)}else if("sameHeightPerRowAndVariedWidth"===t.options.layout){a=1;var S=t.outerWidth(),A=0,C=[],x=0;for(c=1;c<=n.length;c++){l=n[c-1].width();var p=n[c-1].outerWidth(),y=0;n[c]&&(y=n[c].width()),g.push({left:u,top:h}),(_=u+l+y)>S?(x=t._getMaxHeightOfArrayItems(n.slice(A,c)),Math.abs(A-c)>1&&t._setItemPositionHeights(g,A,c,x),_=0,u=0,h+=x,C.push(x),A=c,a++):u+=p}x=t._getMaxHeightOfArrayItems(n.slice(A,c)),C.push(x),Math.abs(A-c)>1&&t._setItemPositionHeights(g,A,c,x),o=C.reduce(function(t,e,i){return t+e},0)}return t.css("height",o),g},_setItemPositionHeights:function(t,e,i,r){if(t&&Array.isArray(t)){e&&!isNaN(e)||(e=0),(!i||isNaN(i)||i>=t.length)&&(i=t.length-1),i<0&&(i=0);var n;for(n=e;n<=i;n++)t[n].height=r}},_setupSeeMoreFeature:function(){var t=this;this._isSeeMoreActive=this._isSeeMoreItemsNumValid()&&"string"==typeof this.options.seeMoreBtnCssSelector,this._isSeeMoreActive&&(this.addClass(t.options.seeMoreActiveCssClass),e(this.options.seeMoreBtnCssSelector).on("click.filterizr-see-more",function(e){e.preventDefault(),e.stopPropagation(),t._isSeeMoreActive=!1;var i=t._getFiltrItems();t._mainArray&&t._mainArray.length>0?t._mainArray=t._mainArray.concat(i):t._mainArray=i,t._subArrays=t._makeSubarrays(),t._activeArray=t._getCollectionByFilter(t.options.filter),t.filter(t.options.filter),t.removeClass(t.options.seeMoreActiveCssClass)}))},_isSeeMoreItemsNumValid:function(){return!isNaN(this.options.seeMoreNumItemsToShow)&&this.options.seeMoreNumItemsToShow>=0},_shouldApplySeeMore:function(){return this._isSeeMoreItemsNumValid&&this._isSeeMoreActive},_getMaxHeightOfArrayItems:function(t){if(!t||!Array.isArray(t))return 0;for(var e=0,i=0,r=0;r<t.length;r++)(i=t[r].outerHeight())>e&&(e=i);return e},_handleFiltering:function(t){for(var e=this,i=e._getArrayOfUniqueItems(e._activeArray,t),r=0;r<i.length;r++)i[r]._filterOut();e._activeArray=t,e._placeItems(t)},_multifilterModeOn:function(){var t=this;return Object.keys(t._toggledCategories).length>0},_isSearchActivated:function(){return this._typedText.length>0},_placeItems:function(t){if(t){var e=this;e._isAnimating=!0,e._itemPositions=e._calcItemPositions();for(var i=0;i<t.length;i++)t[i]._filterIn(e._itemPositions[i])}},_getCollectionByFilter:function(t){var e=this;return"all"===t?e._mainArray:e._subArrays[t-1]},_makeDeepCopy:function(t){var e={};for(var i in t)e[i]=t[i];return e},_comparator:function(t,e){return function(i,r){return"asc"===e?i[t]<r[t]?-1:i[t]>r[t]?1:0:"desc"===e?r[t]<i[t]?-1:r[t]>i[t]?1:0:void 0}},_getArrayOfUniqueItems:function(t,e){var i,r,n=[],o={},s=e?e.length:0;for(i=0;i<s;i++)o[e[i].domIndex]=!0;for(s=t?t.length:0,i=0;i<s;i++)(r=t[i]).domIndex in o||n.push(r);return n},_delayEvent:function(){var t={};return function(e,i,r){if(null===r)throw Error("UniqueID needed");t[r]&&clearTimeout(t[r]),t[r]=setTimeout(e,i)}}(),_fisherYatesShuffle:function(t){for(var e,i,r=t.length;r;)i=Math.floor(Math.random()*r--),e=t[r],t[r]=t[i],t[i]=e;return t}};var r={_init:function(t,e,i){var r=this;return r._parent=e,r._category=r._getCategory(),r._lastPos={},r.domIndex=t,r.sortData=r.data("sort"),r.w=0,r.h=0,r._isFilteredOut=!0,r._filteringOut=!1,r._filteringIn=!1,r._options=i||{},r._options.shouldUseFilterInSeeMoreCss=!!r._options.shouldUseFilterInSeeMoreCss,r.addClass("filteredOut"),r.css(e.options.filterOutCss).css({"-webkit-backface-visibility":"hidden",perspective:"1000px","-webkit-perspective":"1000px","-webkit-transform-style":"preserve-3d",position:"absolute",transition:"all "+e.options.animationDuration+"s "+e.options.easing+" "+r._calcDelay()+"ms"}),r.on("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",function(){r._onTransitionEnd()}),r},_updateDimensions:function(){var t=this;t.w=t.outerWidth(),t.h=t.outerHeight()},_calcDelay:function(){var t=this,e=0;return"progressive"===t._parent.options.delayMode?e=t._parent.options.delay*t.domIndex:t.domIndex%2==0&&(e=t._parent.options.delay),e},_getCategory:function(){var t=this,e=t.data("category");if("string"==typeof e){e=e.split(", ");for(var i=0;i<e.length;i++){if(isNaN(parseInt(e[i])))throw new Error("Filterizr: the value of data-category must be a number, starting from value 1 and increasing.");parseInt(e[i])>t._parent._lastCategory&&(t._parent._lastCategory=parseInt(e[i]))}}else e>t._parent._lastCategory&&(t._parent._lastCategory=e);return e},_onTransitionEnd:function(){var t=this;t._filteringOut&&(t._filteringIn||e(t).addClass("filteredOut"),t._isFilteredOut=!0,t._filteringOut=!1),t._filteringIn&&(t._isFilteredOut||(t._isFilteredOut=!1),t._filteringIn=!1),t._parent._isAnimating&&(t._parent._isShuffling?t._parent.trigger("shufflingEnd"):t._parent._isSorting?t._parent.trigger("sortingEnd"):t._parent.trigger("filteringEnd"),t._parent._isAnimating=!1);var i=t._parent.find(".filtr-item.filterizd"),r=i.filter(".filteredOut");i.length===r.length&&t._parent._shouldSetNoResultsClass(!0)},_filterOut:function(){var t=this,e=t._parent._makeDeepCopy(t._parent.options.filterOutCss);e.transform+=" translate3d("+t._lastPos.left+"px,"+t._lastPos.top+"px, 0)",t.css(e),t.css("pointer-events","none"),t._filteringOut=!0},_filterIn:function(t){var i,r=this;r._options.shouldUseFilterInSeeMoreCss?(i=r._parent._makeDeepCopy(r._parent.options.filterInSeeMoreCss),r._options.shouldUseFilterInSeeMoreCss=!1):i=r._parent._makeDeepCopy(r._parent.options.filterInCss),e(r).removeClass("filteredOut"),r._filteringIn=!0,r._lastPos=t,r.css("pointer-events","auto"),i.transform||(i.transform=""),i.transform+=" translate3d("+t.left+"px,"+t.top+"px, 0)",isNaN(t.height)||(i.height=t.height,r._isForcedHeightSet=!0),r.css(i),!r._isFilteredOut&&r.css("transition")||(r._filteringIn=!1)},_unsetForcedHeight:function(){this._isForcedHeightSet&&(this.css("height",""),this._isForcedHeightSet=!1)}}}(this,jQuery);